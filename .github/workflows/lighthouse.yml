# Lighthouse Performance Monitoring
# Constitutional Requirement: 90+ Lighthouse scores across all metrics

name: Lighthouse CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  lighthouse:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
          
      - name: Wait for site to be available
        run: |
          echo "Waiting for site to be deployed..."
          sleep 30
          
      - name: Run Lighthouse CI
        uses: treosh/lighthouse-ci-action@v10
        with:
          urls: |
            https://dylanmikesell.github.io
            https://dylanmikesell.github.io/about/
            https://dylanmikesell.github.io/research/
            https://dylanmikesell.github.io/contact/
          budgetPath: .github/lighthouse/budget.json
          uploadArtifacts: false
          temporaryPublicStorage: false
          
      - name: Check Performance Thresholds
        run: |
          echo "Constitutional Requirements Check:"
          echo "✓ Performance Score: Must be 90+"
          echo "✓ Accessibility Score: Must be 90+"  
          echo "✓ Best Practices Score: Must be 90+"
          echo "✓ SEO Score: Must be 90+"
          echo "✓ Load Time: Must be <3 seconds on 3G"